"use strict";var x=Object.create;var h=Object.defineProperty;var C=Object.getOwnPropertyDescriptor;var v=Object.getOwnPropertyNames;var E=Object.getPrototypeOf,P=Object.prototype.hasOwnProperty;var T=(e,t,n,a)=>{if(t&&typeof t=="object"||typeof t=="function")for(let o of v(t))!P.call(e,o)&&o!==n&&h(e,o,{get:()=>t[o],enumerable:!(a=C(t,o))||a.enumerable});return e};var d=(e,t,n)=>(n=e!=null?x(E(e)):{},T(t||!e||!e.__esModule?h(n,"default",{value:e,enumerable:!0}):n,e));var F=d(require("express")),i=d(require("fs")),p=d(require("path")),R=(0,F.default)(),j=process.env.PORT||3e3,f=process.env.BASE_DIRECTORY||p.default.join(__dirname,"files"),u=e=>{try{return i.default.existsSync(e)}catch{return!1}};R.get("/:domain.:tld.:ext(js|css)",(e,t)=>{(async()=>{let{domain:n,tld:a,ext:o}=e.params,{prependFile:c,appendFile:l}=e.query,S=`${n}.${a}.${o}`,y=p.default.join(f,S);if(!u(y))return t.status(404).json({error:"File not found"});let s=i.default.readFileSync(y,"utf-8");if(c&&typeof c=="string"){let r=p.default.join(f,c);u(r)&&(s=i.default.readFileSync(r,"utf-8")+s)}if(l&&typeof l=="string"){let r=p.default.join(f,l);if(u(r)){let m=i.default.readFileSync(r,"utf-8");s=s+m}}let g=o==="js"?"application/javascript":"text/css";t.setHeader("Content-Type",g),t.send(s)})().catch(n=>{console.error("Error in async route handler:",n),t.status(500).json({error:"Internal Server Error"})})});R.listen(j,()=>{console.log(`Server is running on http://localhost:${j}`)});
