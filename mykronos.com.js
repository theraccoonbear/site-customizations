"use strict";var U=function(){"use strict";function t(n,o){var s=n.l+o.l,d={h:n.h+o.h+(s/2>>>31)>>>0,l:s>>>0};n.h=d.h,n.l=d.l}function e(n,o){n.h^=o.h,n.h>>>=0,n.l^=o.l,n.l>>>=0}function r(n,o){var s={h:n.h<<o|n.l>>>32-o,l:n.l<<o|n.h>>>32-o};n.h=s.h,n.l=s.l}function i(n){var o=n.l;n.l=n.h,n.h=o}function a(n,o,s,d){t(n,o),t(s,d),r(o,13),r(d,16),e(o,n),e(d,s),i(n),t(s,o),t(n,d),r(o,17),r(d,21),e(o,s),e(d,n),i(s)}function l(n,o){return n[o+3]<<24|n[o+2]<<16|n[o+1]<<8|n[o]}function m(n,o){typeof o=="string"&&(o=g(o));var s={h:n[1]>>>0,l:n[0]>>>0},d={h:n[3]>>>0,l:n[2]>>>0},u={h:s.h,l:s.l},h=s,f={h:d.h,l:d.l},p=d,x=o.length,w=x-7,c=new Uint8Array(new ArrayBuffer(8));e(u,{h:1936682341,l:1886610805}),e(f,{h:1685025377,l:1852075885}),e(h,{h:1819895653,l:1852142177}),e(p,{h:1952801890,l:2037671283});for(var y=0;y<w;){var v={h:l(o,y+4),l:l(o,y)};e(p,v),a(u,f,h,p),a(u,f,h,p),e(u,v),y+=8}c[7]=x;for(var T=0;y<x;)c[T++]=o[y++];for(;T<7;)c[T++]=0;var R={h:c[7]<<24|c[6]<<16|c[5]<<8|c[4],l:c[3]<<24|c[2]<<16|c[1]<<8|c[0]};e(p,R),a(u,f,h,p),a(u,f,h,p),e(u,R),e(h,{h:0,l:255}),a(u,f,h,p),a(u,f,h,p),a(u,f,h,p),a(u,f,h,p);var D=u;return e(D,f),e(D,h),e(D,p),D}function g(n){if(typeof TextEncoder=="function")return new TextEncoder().encode(n);n=unescape(encodeURIComponent(n));for(var o=new Uint8Array(n.length),s=0,d=n.length;s<d;s++)o[s]=n.charCodeAt(s);return o}return{hash:m,hash_hex:function(n,o){var s=m(n,o);return("0000000"+s.h.toString(16)).substr(-8)+("0000000"+s.l.toString(16)).substr(-8)},hash_uint:function(n,o){var s=m(n,o);return 4294967296*(2097151&s.h)+s.l},string16_to_key:function(n){var o=g(n);if(o.length!==16)throw Error("Key length must be 16 bytes");var s=new Uint32Array(4);return s[0]=l(o,0),s[1]=l(o,4),s[2]=l(o,8),s[3]=l(o,12),s},string_to_u8:g}}();var k=t=>{document.readyState!=="loading"?t():document.addEventListener("DOMContentLoaded",t)};window.ready=k;var Z=100,b=async(t,e)=>{e=typeof e=="number"?e:1;let r=document.querySelectorAll(t);if(r&&r.length>0)return r;if(e>Z)throw new Error(`Unable to find '${t}'; giving up.`);return console.debug(`#${e} selector miss on '${t}'`),await O(100),b(t,e+1)};var A=async(t,e)=>{new RegExp(t,"i").test(document.location.pathname)&&(console.log(`Conditional path match for "${t}"`),k(()=>{console.log(`Executing for "${t}"`),e()}))},I=(t,e)=>`data:${t};charset=utf-8;base64,${btoa(e)}`,N=(t,e)=>{var r=document.createElement("a");r.download=e,r.href=t,r.click()},M=t=>V(U.hash_hex("calendarFoo",t)),S=(t,e)=>(e.getTime()-t.getTime())/1e3/60,L=(t,e)=>S(t,e)/60,O=async t=>new Promise(e=>setTimeout(e,t)),C=(t,e)=>{let r=new Date(t);return r.setDate(t.getDate()+e),r.toISOString().split("T")[0]},E=t=>{let e=new Date(t),r=e.getFullYear(),i=`${e.getMonth()+1<10?"0":""}${e.getMonth()+1}`,a=(e.getDate()<10?"0":"")+e.getDate(),l=(e.getHours()<10?"0":"")+e.getHours(),m=(e.getMinutes()<10?"0":"")+e.getMinutes(),g=(e.getSeconds()<10?"0":"")+e.getSeconds();return`${r}${i}${a}T${l}${m}${g}`},$=t=>t.toLocaleTimeString("en-US",{hour12:!0,hour:"numeric",minute:"2-digit",second:"2-digit"}).replace(/:\d{2}\s+/," "),P=t=>t.toLocaleDateString("en-US",{weekday:"short",month:"short",day:"numeric"}),V=t=>(t=t.replace("-",""),"xxxxxxxx-xxxx-4xxx-xxxx-xxxxxxxxxxxx".replace(/[x]/g,(e,r)=>t[r%t.length])),_=t=>t.toLowerCase().replace(/[a-z]/gi,e=>String.fromCharCode(e.charCodeAt(0)+(e.toLowerCase()<="m"?13:-13))),Y=async(t,e,r,i,a)=>{t=t.trim().toUpperCase(),r=typeof r>"u"||r===null?null:r.toString(),i=typeof i>"u"?{}:{...i},a=typeof a=="string"&&a.toLowerCase()==="text"?"text":"json";let l,m;t!="get"&&t!="head"&&(l={body:r},m={"content-type":"application/json"});let g=await fetch(e,{headers:{accept:"application/json, text/plain, */*","accept-language":"en-US,en;q=0.9",...m,"cache-control":"no-cache","device-type":"desktop",page:"home",pragma:"no-cache","sec-ch-ua":'"Not.A/Brand";v="8", "Chromium";v="114", "Google Chrome";v="114"',"sec-ch-ua-mobile":"?0","sec-ch-ua-platform":'"macOS"',"sec-fetch-dest":"empty","sec-fetch-mode":"cors","sec-fetch-site":"same-origin","sec-gpc":"1",...i},referrerPolicy:"strict-origin-when-cross-origin",...l,method:t,mode:"cors",credentials:"include"});if(!g.ok)throw console.warn("Failed request:",e,g),new Error(`Error performing ${t} for ${e}`);if(g.status.toString().indexOf("2")!==0)throw new Error(`Received ${g.status} ${g.statusText}. ${t.trim().toUpperCase()} ${e}`);return a=="text"?g.text():g.json()};var j=(t,e,r)=>Y("post",t,e,r);console.log("your script debugging entry point here...");var q=_(atob("ZXJwZXJuZ3ZiYW55cmRodmMtZmYzLmNlcS56bHhlYmFiZi5wYno=")),F=atob("UkVJ"),H=t=>{let e=1;return console.log(t,t.match(/.{1,75}/)),(t.match(/.{1,75}/g)??[]).map(r=>(console.log("p",r),`${r}\r
 `+" ".repeat(e++))).join("").trim()},B=(t,e,r)=>{let i=new Date(t.orderedSegments[0].startDateTimeUTC),a=new Date(t.orderedSegments[t.orderedSegments.length-1].endDateTimeUTC),l=t.orderedSegments.filter(c=>c.segmentType.symbolicId==="break_segment"),m=l.map(c=>S(new Date(c.startDateTimeUTC),new Date(c.endDateTimeUTC))).reduce((c,y)=>c+y,0),g=l.map(c=>$(new Date(c.startDateTimeUTC))).join(", "),n=m>0?`${m} minutes break at ${g}`:"no breaks",o=L(i,a),s=o.toPrecision(3).replace(/0+$/,"0"),d=(o-m/60).toPrecision(3).replace(/0+$/,"0"),u=t.job,h=`${F} from ${$(i)} to ${$(a)} (${s} [${d}] hours)`,f=`Shift in ${u} at ${F} from ${$(i)} to ${$(a)} on ${P(i)}. ${s} hours with ${n}`,x=";TZID=America/Chicago",w=["BEGIN:VEVENT",`UID: ${M(E(i)+E(a))}`,`DTSTAMP${x}:${E(i)}`,`ORGANIZER;CN=${e}:MAILTO:${r}`,`DTSTART${x}:${E(i)}`,`DTEND${x}:${E(a)}`,`${H(`SUMMARY:${h}`)}`,`${H(`DESCRIPTION:${f}`)}`,"END:VEVENT"].join(`\r
`);return{...t,iCal:w}},G=t=>`https://${q}${t}`;var J=()=>document.cookie.split(/;\s*/).map(t=>t.split(/=/)).filter(t=>t[0]=="XSRF-TOKEN").reduce((t,e)=>e[1],""),z=()=>{let t=new Date,e=C(t,-14),r=C(t,14);return{startDate:e,endDate:r,types:[{name:"approvedtimeoffrequest"},{name:"holiday"},{name:"inprogresstimeoffrequest"},{name:"openshift"},{name:"paycodeedit"},{name:"regularshift"},{name:"scheduletag"},{name:"transfershift"}]}};var K=async(t,e)=>{let r=await J(),i=z();return(await j(G("/myschedule/eventDispatcher"),JSON.stringify(i),{"x-xsrf-token":r})).map(l=>B(l,t,e))},W=async(t,e)=>{let a=["BEGIN:VCALENDAR","VERSION:2.0","PRODID:-//hacksw/handcal//NONSGML v1.0//EN",`${(await K(t,e)).map(l=>l.iCal).join(`
`)}`,"END:VCALENDAR"].join(`\r
`);console.log(a),N(I("text/calendar",a),"schedule.vcs")},Q=async t=>{try{return(await b("#employeeProfileImage_"))[0]}catch{return null}};var tt=async()=>{let t=await Q();if(t==null||t.parentElement==null){console.error("Couldn't find the header");return}let e=document.createElement("button");e.setAttribute("value","Download vCal"),e.innerHTML="Download vCal",e.addEventListener("click",()=>W("Me","me@host.com")),t.parentElement.appendChild(e)};A("/wfd/home",tt);
